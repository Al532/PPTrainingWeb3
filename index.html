<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ear Training</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" href="favicon.svg" type="image/svg+xml">
</head>
<body>
  <header>
    <h1>Perfect Pitch Training</h1>
    <p>
      Listen to the played sample, then identify its chroma by clicking the corresponding
      button or by playing the matching note on your MIDI keyboard.
    </p>

  </header>

  <main>
    <section class="status">
      <div class="status-row">
        <div id="midi-status" class="pill muted">MIDI: detecting…</div>
      </div>
    </section>

    <section class="series" aria-label="Series playback">
      <details class="series-details" open>
        <summary class="series-summary">
          <div class="series-header">
            <h2>Series</h2>
            <div id="series-active-pill" class="pill muted" hidden>
              Series active — settings locked
            </div>
          </div>
          <span class="series-chevron" aria-hidden="true">‹</span>
        </summary>
        <div class="series-body">
          <div class="controls-row">
            <label for="series-length-input">Series length</label>
            <input
              type="number"
              id="series-length-input"
              min="1"
              max="500"
              value="20"
            >
            <button type="button" id="series-generate-button" class="secondary-button">
              Generate series
            </button>
          </div>
          <div class="controls-row">
            <label for="series-name-input">Series name</label>
            <input
              type="text"
              id="series-name-input"
              placeholder="Optional name"
            >
          </div>
          <div class="controls-row toggle-row">
            <label class="checkbox-label">
              <input type="checkbox" id="series-randomize-start-toggle">
              <div class="label">Randomize starting note</div>
            </label>
          </div>
          <div class="controls-row">
            <label for="series-select">Select series</label>
            <select id="series-select"></select>
            <button type="button" id="series-delete-button" class="secondary-button">
              Delete series
            </button>
          </div>
          <div class="controls-row">
            <button type="button" id="series-play-button" class="secondary-button">
              Play series
            </button>
            <button type="button" id="series-stop-button" class="secondary-button" disabled>
              Stop series
            </button>
          </div>
          <div class="controls-row">
            <button type="button" id="series-export-button" class="secondary-button" disabled>
              Export series
            </button>
            <button type="button" id="series-import-button" class="secondary-button">
              Import series
            </button>
            <input type="file" id="series-import-input" accept="application/json" hidden>
          </div>
          <div id="series-status" class="export-status muted" aria-live="polite" hidden></div>
        </div>
      </details>
    </section>

    <section class="controls" aria-label="Chromas">
      <!--
      <div class="controls-row toggle-row">
        <label class="checkbox-label">
          <input type="checkbox" id="randomize-buttons-toggle">
          <div class="label">Randomize answer button order</div>
        </label>
      </div>
      -->
      <div class="controls-row" id="feedback-row">
        <label for="feedback-select">Feedback</label>
        <select id="feedback-select"></select>
      </div>
      <div class="replay-row" id="replay-row">
        <button type="button" id="replay-button" class="chroma replay-button" disabled>
          Replay
        </button>
      </div>
      <div id="chroma-buttons" class="buttons"></div>
    </section>

    <section class="stats" aria-label="Session stats">
      <div class="stats-row">
        <button
          type="button"
          id="stats-button"
          class="stats-toggle"
          aria-expanded="false"
          aria-controls="stats-output"
        >
          <span class="chevron" aria-hidden="true">‹</span>
          <span class="label">Stats</span>
        </button>
        <div id="stats-output" class="stats-output" aria-live="polite"></div>
      </div>
      <div class="stats-row export-row">
        <button type="button" id="export-logs-button" class="secondary-button">
          Export logs (JSON)
        </button>
        <button type="button" id="export-logs-last-button" class="secondary-button">
          Export logs (last 1000)
        </button>
        <div id="export-logs-status" class="export-status muted" aria-live="polite" hidden></div>
      </div>
    </section>
  </main>

  <script type="module" src="script.js"></script>
</body>
</html>
